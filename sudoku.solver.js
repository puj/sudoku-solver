/*jslint white: true, devel: true, onevar: true, browser: true, undef: true, nomen: true, regexp: true, continue: true, windows: true, newcap: true, maxerr: 50, indent: 4 */
(function (global) {
    /*
        Create an unique namespace for sudoku solver.
        And setup the puzzle's original state.
    */
	var sudoku = {

        version: "0.1",
        clone: function (obj) {
            var i,
                target = {};
            for (i in obj) {
                if (obj.hasOwnProperty(i)) {
                    target[i] = obj[i];
                }
            }
            return target;
        },

        SQUARES: ["A1", "A2", "A3", "A4", "A5", "A6", "A7", "A8", "A9", "B1", "B2", "B3", "B4", "B5", "B6", "B7", "B8", "B9", "C1", "C2", "C3", "C4", "C5", "C6", "C7", "C8", "C9", "D1", "D2", "D3", "D4", "D5", "D6", "D7", "D8", "D9", "E1", "E2", "E3", "E4", "E5", "E6", "E7", "E8", "E9", "F1", "F2", "F3", "F4", "F5", "F6", "F7", "F8", "F9", "G1", "G2", "G3", "G4", "G5", "G6", "G7", "G8", "G9", "H1", "H2", "H3", "H4", "H5", "H6", "H7", "H8", "H9", "I1", "I2", "I3", "I4", "I5", "I6", "I7", "I8", "I9"],

        UNITS: ({A1: [#5=["A1", "B1", "C1", "D1", "E1", "F1", "G1", "H1", "I1"], #1=["A1", "A2", "A3", "A4", "A5", "A6", "A7", "A8", "A9"], #2=["A1", "A2", "A3", "B1", "B2", "B3", "C1", "C2", "C3"]], A2: [#6=["A2", "B2", "C2", "D2", "E2", "F2", "G2", "H2", "I2"], #1#, #2#], A3: [#8=["A3", "B3", "C3", "D3", "E3", "F3", "G3", "H3", "I3"], #1#, #2#], A4: [#9=["A4", "B4", "C4", "D4", "E4", "F4", "G4", "H4", "I4"], #1#, #3=["A4", "A5", "A6", "B4", "B5", "B6", "C4", "C5", "C6"]], A5: [#10=["A5", "B5", "C5", "D5", "E5", "F5", "G5", "H5", "I5"], #1#, #3#], A6: [#11=["A6", "B6", "C6", "D6", "E6", "F6", "G6", "H6", "I6"], #1#, #3#], A7: [#12=["A7", "B7", "C7", "D7", "E7", "F7", "G7", "H7", "I7"], #1#, #4=["A7", "A8", "A9", "B7", "B8", "B9", "C7", "C8", "C9"]], A8: [#13=["A8", "B8", "C8", "D8", "E8", "F8", "G8", "H8", "I8"], #1#, #4#], A9: [#14=["A9", "B9", "C9", "D9", "E9", "F9", "G9", "H9", "I9"], #1#, #4#], B1: [#5#, #7=["B1", "B2", "B3", "B4", "B5", "B6", "B7", "B8", "B9"], #2#], B2: [#6#, #7#, #2#], B3: [#8#, #7#, #2#], B4: [#9#, #7#, #3#], B5: [#10#, #7#, #3#], B6: [#11#, #7#, #3#], B7: [#12#, #7#, #4#], B8: [#13#, #7#, #4#], B9: [#14#, #7#, #4#], C1: [#5#, #15=["C1", "C2", "C3", "C4", "C5", "C6", "C7", "C8", "C9"], #2#], C2: [#6#, #15#, #2#], C3: [#8#, #15#, #2#], C4: [#9#, #15#, #3#], C5: [#10#, #15#, #3#], C6: [#11#, #15#, #3#], C7: [#12#, #15#, #4#], C8: [#13#, #15#, #4#], C9: [#14#, #15#, #4#], D1: [#5#, #16=["D1", "D2", "D3", "D4", "D5", "D6", "D7", "D8", "D9"], #17=["D1", "D2", "D3", "E1", "E2", "E3", "F1", "F2", "F3"]], D2: [#6#, #16#, #17#], D3: [#8#, #16#, #17#], D4: [#9#, #16#, #18=["D4", "D5", "D6", "E4", "E5", "E6", "F4", "F5", "F6"]], D5: [#10#, #16#, #18#], D6: [#11#, #16#, #18#], D7: [#12#, #16#, #19=["D7", "D8", "D9", "E7", "E8", "E9", "F7", "F8", "F9"]], D8: [#13#, #16#, #19#], D9: [#14#, #16#, #19#], E1: [#5#, #20=["E1", "E2", "E3", "E4", "E5", "E6", "E7", "E8", "E9"], #17#], E2: [#6#, #20#, #17#], E3: [#8#, #20#, #17#], E4: [#9#, #20#, #18#], E5: [#10#, #20#, #18#], E6: [#11#, #20#, #18#], E7: [#12#, #20#, #19#], E8: [#13#, #20#, #19#], E9: [#14#, #20#, #19#], F1: [#5#, #21=["F1", "F2", "F3", "F4", "F5", "F6", "F7", "F8", "F9"], #17#], F2: [#6#, #21#, #17#], F3: [#8#, #21#, #17#], F4: [#9#, #21#, #18#], F5: [#10#, #21#, #18#], F6: [#11#, #21#, #18#], F7: [#12#, #21#, #19#], F8: [#13#, #21#, #19#], F9: [#14#, #21#, #19#], G1: [#5#, #22=["G1", "G2", "G3", "G4", "G5", "G6", "G7", "G8", "G9"], #23=["G1", "G2", "G3", "H1", "H2", "H3", "I1", "I2", "I3"]], G2: [#6#, #22#, #23#], G3: [#8#, #22#, #23#], G4: [#9#, #22#, #24=["G4", "G5", "G6", "H4", "H5", "H6", "I4", "I5", "I6"]], G5: [#10#, #22#, #24#], G6: [#11#, #22#, #24#], G7: [#12#, #22#, #25=["G7", "G8", "G9", "H7", "H8", "H9", "I7", "I8", "I9"]], G8: [#13#, #22#, #25#], G9: [#14#, #22#, #25#], H1: [#5#, #26=["H1", "H2", "H3", "H4", "H5", "H6", "H7", "H8", "H9"], #23#], H2: [#6#, #26#, #23#], H3: [#8#, #26#, #23#], H4: [#9#, #26#, #24#], H5: [#10#, #26#, #24#], H6: [#11#, #26#, #24#], H7: [#12#, #26#, #25#], H8: [#13#, #26#, #25#], H9: [#14#, #26#, #25#], I1: [#5#, #27=["I1", "I2", "I3", "I4", "I5", "I6", "I7", "I8", "I9"], #23#], I2: [#6#, #27#, #23#], I3: [#8#, #27#, #23#], I4: [#9#, #27#, #24#], I5: [#10#, #27#, #24#], I6: [#11#, #27#, #24#], I7: [#12#, #27#, #25#], I8: [#13#, #27#, #25#], I9: [#14#, #27#, #25#]}),
       
        PEERS: ({A1: ["B1", "C1", "D1", "E1", "F1", "G1", "H1", "I1", "A2", "A3", "A4", "A5", "A6", "A7", "A8", "A9", "B2", "B3", "C2", "C3"], A2: ["B2", "C2", "D2", "E2", "F2", "G2", "H2", "I2", "A1", "A3", "A4", "A5", "A6", "A7", "A8", "A9", "B1", "B3", "C1", "C3"], A3: ["B3", "C3", "D3", "E3", "F3", "G3", "H3", "I3", "A1", "A2", "A4", "A5", "A6", "A7", "A8", "A9", "B1", "B2", "C1", "C2"], A4: ["B4", "C4", "D4", "E4", "F4", "G4", "H4", "I4", "A1", "A2", "A3", "A5", "A6", "A7", "A8", "A9", "B5", "B6", "C5", "C6"], A5: ["B5", "C5", "D5", "E5", "F5", "G5", "H5", "I5", "A1", "A2", "A3", "A4", "A6", "A7", "A8", "A9", "B4", "B6", "C4", "C6"], A6: ["B6", "C6", "D6", "E6", "F6", "G6", "H6", "I6", "A1", "A2", "A3", "A4", "A5", "A7", "A8", "A9", "B4", "B5", "C4", "C5"], A7: ["B7", "C7", "D7", "E7", "F7", "G7", "H7", "I7", "A1", "A2", "A3", "A4", "A5", "A6", "A8", "A9", "B8", "B9", "C8", "C9"], A8: ["B8", "C8", "D8", "E8", "F8", "G8", "H8", "I8", "A1", "A2", "A3", "A4", "A5", "A6", "A7", "A9", "B7", "B9", "C7", "C9"], A9: ["B9", "C9", "D9", "E9", "F9", "G9", "H9", "I9", "A1", "A2", "A3", "A4", "A5", "A6", "A7", "A8", "B7", "B8", "C7", "C8"], B1: ["A1", "C1", "D1", "E1", "F1", "G1", "H1", "I1", "B2", "B3", "B4", "B5", "B6", "B7", "B8", "B9", "A2", "A3", "C2", "C3"], B2: ["A2", "C2", "D2", "E2", "F2", "G2", "H2", "I2", "B1", "B3", "B4", "B5", "B6", "B7", "B8", "B9", "A1", "A3", "C1", "C3"], B3: ["A3", "C3", "D3", "E3", "F3", "G3", "H3", "I3", "B1", "B2", "B4", "B5", "B6", "B7", "B8", "B9", "A1", "A2", "C1", "C2"], B4: ["A4", "C4", "D4", "E4", "F4", "G4", "H4", "I4", "B1", "B2", "B3", "B5", "B6", "B7", "B8", "B9", "A5", "A6", "C5", "C6"], B5: ["A5", "C5", "D5", "E5", "F5", "G5", "H5", "I5", "B1", "B2", "B3", "B4", "B6", "B7", "B8", "B9", "A4", "A6", "C4", "C6"], B6: ["A6", "C6", "D6", "E6", "F6", "G6", "H6", "I6", "B1", "B2", "B3", "B4", "B5", "B7", "B8", "B9", "A4", "A5", "C4", "C5"], B7: ["A7", "C7", "D7", "E7", "F7", "G7", "H7", "I7", "B1", "B2", "B3", "B4", "B5", "B6", "B8", "B9", "A8", "A9", "C8", "C9"], B8: ["A8", "C8", "D8", "E8", "F8", "G8", "H8", "I8", "B1", "B2", "B3", "B4", "B5", "B6", "B7", "B9", "A7", "A9", "C7", "C9"], B9: ["A9", "C9", "D9", "E9", "F9", "G9", "H9", "I9", "B1", "B2", "B3", "B4", "B5", "B6", "B7", "B8", "A7", "A8", "C7", "C8"], C1: ["A1", "B1", "D1", "E1", "F1", "G1", "H1", "I1", "C2", "C3", "C4", "C5", "C6", "C7", "C8", "C9", "A2", "A3", "B2", "B3"], C2: ["A2", "B2", "D2", "E2", "F2", "G2", "H2", "I2", "C1", "C3", "C4", "C5", "C6", "C7", "C8", "C9", "A1", "A3", "B1", "B3"], C3: ["A3", "B3", "D3", "E3", "F3", "G3", "H3", "I3", "C1", "C2", "C4", "C5", "C6", "C7", "C8", "C9", "A1", "A2", "B1", "B2"], C4: ["A4", "B4", "D4", "E4", "F4", "G4", "H4", "I4", "C1", "C2", "C3", "C5", "C6", "C7", "C8", "C9", "A5", "A6", "B5", "B6"], C5: ["A5", "B5", "D5", "E5", "F5", "G5", "H5", "I5", "C1", "C2", "C3", "C4", "C6", "C7", "C8", "C9", "A4", "A6", "B4", "B6"], C6: ["A6", "B6", "D6", "E6", "F6", "G6", "H6", "I6", "C1", "C2", "C3", "C4", "C5", "C7", "C8", "C9", "A4", "A5", "B4", "B5"], C7: ["A7", "B7", "D7", "E7", "F7", "G7", "H7", "I7", "C1", "C2", "C3", "C4", "C5", "C6", "C8", "C9", "A8", "A9", "B8", "B9"], C8: ["A8", "B8", "D8", "E8", "F8", "G8", "H8", "I8", "C1", "C2", "C3", "C4", "C5", "C6", "C7", "C9", "A7", "A9", "B7", "B9"], C9: ["A9", "B9", "D9", "E9", "F9", "G9", "H9", "I9", "C1", "C2", "C3", "C4", "C5", "C6", "C7", "C8", "A7", "A8", "B7", "B8"], D1: ["A1", "B1", "C1", "E1", "F1", "G1", "H1", "I1", "D2", "D3", "D4", "D5", "D6", "D7", "D8", "D9", "E2", "E3", "F2", "F3"], D2: ["A2", "B2", "C2", "E2", "F2", "G2", "H2", "I2", "D1", "D3", "D4", "D5", "D6", "D7", "D8", "D9", "E1", "E3", "F1", "F3"], D3: ["A3", "B3", "C3", "E3", "F3", "G3", "H3", "I3", "D1", "D2", "D4", "D5", "D6", "D7", "D8", "D9", "E1", "E2", "F1", "F2"], D4: ["A4", "B4", "C4", "E4", "F4", "G4", "H4", "I4", "D1", "D2", "D3", "D5", "D6", "D7", "D8", "D9", "E5", "E6", "F5", "F6"], D5: ["A5", "B5", "C5", "E5", "F5", "G5", "H5", "I5", "D1", "D2", "D3", "D4", "D6", "D7", "D8", "D9", "E4", "E6", "F4", "F6"], D6: ["A6", "B6", "C6", "E6", "F6", "G6", "H6", "I6", "D1", "D2", "D3", "D4", "D5", "D7", "D8", "D9", "E4", "E5", "F4", "F5"], D7: ["A7", "B7", "C7", "E7", "F7", "G7", "H7", "I7", "D1", "D2", "D3", "D4", "D5", "D6", "D8", "D9", "E8", "E9", "F8", "F9"], D8: ["A8", "B8", "C8", "E8", "F8", "G8", "H8", "I8", "D1", "D2", "D3", "D4", "D5", "D6", "D7", "D9", "E7", "E9", "F7", "F9"], D9: ["A9", "B9", "C9", "E9", "F9", "G9", "H9", "I9", "D1", "D2", "D3", "D4", "D5", "D6", "D7", "D8", "E7", "E8", "F7", "F8"], E1: ["A1", "B1", "C1", "D1", "F1", "G1", "H1", "I1", "E2", "E3", "E4", "E5", "E6", "E7", "E8", "E9", "D2", "D3", "F2", "F3"], E2: ["A2", "B2", "C2", "D2", "F2", "G2", "H2", "I2", "E1", "E3", "E4", "E5", "E6", "E7", "E8", "E9", "D1", "D3", "F1", "F3"], E3: ["A3", "B3", "C3", "D3", "F3", "G3", "H3", "I3", "E1", "E2", "E4", "E5", "E6", "E7", "E8", "E9", "D1", "D2", "F1", "F2"], E4: ["A4", "B4", "C4", "D4", "F4", "G4", "H4", "I4", "E1", "E2", "E3", "E5", "E6", "E7", "E8", "E9", "D5", "D6", "F5", "F6"], E5: ["A5", "B5", "C5", "D5", "F5", "G5", "H5", "I5", "E1", "E2", "E3", "E4", "E6", "E7", "E8", "E9", "D4", "D6", "F4", "F6"], E6: ["A6", "B6", "C6", "D6", "F6", "G6", "H6", "I6", "E1", "E2", "E3", "E4", "E5", "E7", "E8", "E9", "D4", "D5", "F4", "F5"], E7: ["A7", "B7", "C7", "D7", "F7", "G7", "H7", "I7", "E1", "E2", "E3", "E4", "E5", "E6", "E8", "E9", "D8", "D9", "F8", "F9"], E8: ["A8", "B8", "C8", "D8", "F8", "G8", "H8", "I8", "E1", "E2", "E3", "E4", "E5", "E6", "E7", "E9", "D7", "D9", "F7", "F9"], E9: ["A9", "B9", "C9", "D9", "F9", "G9", "H9", "I9", "E1", "E2", "E3", "E4", "E5", "E6", "E7", "E8", "D7", "D8", "F7", "F8"], F1: ["A1", "B1", "C1", "D1", "E1", "G1", "H1", "I1", "F2", "F3", "F4", "F5", "F6", "F7", "F8", "F9", "D2", "D3", "E2", "E3"], F2: ["A2", "B2", "C2", "D2", "E2", "G2", "H2", "I2", "F1", "F3", "F4", "F5", "F6", "F7", "F8", "F9", "D1", "D3", "E1", "E3"], F3: ["A3", "B3", "C3", "D3", "E3", "G3", "H3", "I3", "F1", "F2", "F4", "F5", "F6", "F7", "F8", "F9", "D1", "D2", "E1", "E2"], F4: ["A4", "B4", "C4", "D4", "E4", "G4", "H4", "I4", "F1", "F2", "F3", "F5", "F6", "F7", "F8", "F9", "D5", "D6", "E5", "E6"], F5: ["A5", "B5", "C5", "D5", "E5", "G5", "H5", "I5", "F1", "F2", "F3", "F4", "F6", "F7", "F8", "F9", "D4", "D6", "E4", "E6"], F6: ["A6", "B6", "C6", "D6", "E6", "G6", "H6", "I6", "F1", "F2", "F3", "F4", "F5", "F7", "F8", "F9", "D4", "D5", "E4", "E5"], F7: ["A7", "B7", "C7", "D7", "E7", "G7", "H7", "I7", "F1", "F2", "F3", "F4", "F5", "F6", "F8", "F9", "D8", "D9", "E8", "E9"], F8: ["A8", "B8", "C8", "D8", "E8", "G8", "H8", "I8", "F1", "F2", "F3", "F4", "F5", "F6", "F7", "F9", "D7", "D9", "E7", "E9"], F9: ["A9", "B9", "C9", "D9", "E9", "G9", "H9", "I9", "F1", "F2", "F3", "F4", "F5", "F6", "F7", "F8", "D7", "D8", "E7", "E8"], G1: ["A1", "B1", "C1", "D1", "E1", "F1", "H1", "I1", "G2", "G3", "G4", "G5", "G6", "G7", "G8", "G9", "H2", "H3", "I2", "I3"], G2: ["A2", "B2", "C2", "D2", "E2", "F2", "H2", "I2", "G1", "G3", "G4", "G5", "G6", "G7", "G8", "G9", "H1", "H3", "I1", "I3"], G3: ["A3", "B3", "C3", "D3", "E3", "F3", "H3", "I3", "G1", "G2", "G4", "G5", "G6", "G7", "G8", "G9", "H1", "H2", "I1", "I2"], G4: ["A4", "B4", "C4", "D4", "E4", "F4", "H4", "I4", "G1", "G2", "G3", "G5", "G6", "G7", "G8", "G9", "H5", "H6", "I5", "I6"], G5: ["A5", "B5", "C5", "D5", "E5", "F5", "H5", "I5", "G1", "G2", "G3", "G4", "G6", "G7", "G8", "G9", "H4", "H6", "I4", "I6"], G6: ["A6", "B6", "C6", "D6", "E6", "F6", "H6", "I6", "G1", "G2", "G3", "G4", "G5", "G7", "G8", "G9", "H4", "H5", "I4", "I5"], G7: ["A7", "B7", "C7", "D7", "E7", "F7", "H7", "I7", "G1", "G2", "G3", "G4", "G5", "G6", "G8", "G9", "H8", "H9", "I8", "I9"], G8: ["A8", "B8", "C8", "D8", "E8", "F8", "H8", "I8", "G1", "G2", "G3", "G4", "G5", "G6", "G7", "G9", "H7", "H9", "I7", "I9"], G9: ["A9", "B9", "C9", "D9", "E9", "F9", "H9", "I9", "G1", "G2", "G3", "G4", "G5", "G6", "G7", "G8", "H7", "H8", "I7", "I8"], H1: ["A1", "B1", "C1", "D1", "E1", "F1", "G1", "I1", "H2", "H3", "H4", "H5", "H6", "H7", "H8", "H9", "G2", "G3", "I2", "I3"], H2: ["A2", "B2", "C2", "D2", "E2", "F2", "G2", "I2", "H1", "H3", "H4", "H5", "H6", "H7", "H8", "H9", "G1", "G3", "I1", "I3"], H3: ["A3", "B3", "C3", "D3", "E3", "F3", "G3", "I3", "H1", "H2", "H4", "H5", "H6", "H7", "H8", "H9", "G1", "G2", "I1", "I2"], H4: ["A4", "B4", "C4", "D4", "E4", "F4", "G4", "I4", "H1", "H2", "H3", "H5", "H6", "H7", "H8", "H9", "G5", "G6", "I5", "I6"], H5: ["A5", "B5", "C5", "D5", "E5", "F5", "G5", "I5", "H1", "H2", "H3", "H4", "H6", "H7", "H8", "H9", "G4", "G6", "I4", "I6"], H6: ["A6", "B6", "C6", "D6", "E6", "F6", "G6", "I6", "H1", "H2", "H3", "H4", "H5", "H7", "H8", "H9", "G4", "G5", "I4", "I5"], H7: ["A7", "B7", "C7", "D7", "E7", "F7", "G7", "I7", "H1", "H2", "H3", "H4", "H5", "H6", "H8", "H9", "G8", "G9", "I8", "I9"], H8: ["A8", "B8", "C8", "D8", "E8", "F8", "G8", "I8", "H1", "H2", "H3", "H4", "H5", "H6", "H7", "H9", "G7", "G9", "I7", "I9"], H9: ["A9", "B9", "C9", "D9", "E9", "F9", "G9", "I9", "H1", "H2", "H3", "H4", "H5", "H6", "H7", "H8", "G7", "G8", "I7", "I8"], I1: ["A1", "B1", "C1", "D1", "E1", "F1", "G1", "H1", "I2", "I3", "I4", "I5", "I6", "I7", "I8", "I9", "G2", "G3", "H2", "H3"], I2: ["A2", "B2", "C2", "D2", "E2", "F2", "G2", "H2", "I1", "I3", "I4", "I5", "I6", "I7", "I8", "I9", "G1", "G3", "H1", "H3"], I3: ["A3", "B3", "C3", "D3", "E3", "F3", "G3", "H3", "I1", "I2", "I4", "I5", "I6", "I7", "I8", "I9", "G1", "G2", "H1", "H2"], I4: ["A4", "B4", "C4", "D4", "E4", "F4", "G4", "H4", "I1", "I2", "I3", "I5", "I6", "I7", "I8", "I9", "G5", "G6", "H5", "H6"], I5: ["A5", "B5", "C5", "D5", "E5", "F5", "G5", "H5", "I1", "I2", "I3", "I4", "I6", "I7", "I8", "I9", "G4", "G6", "H4", "H6"], I6: ["A6", "B6", "C6", "D6", "E6", "F6", "G6", "H6", "I1", "I2", "I3", "I4", "I5", "I7", "I8", "I9", "G4", "G5", "H4", "H5"], I7: ["A7", "B7", "C7", "D7", "E7", "F7", "G7", "H7", "I1", "I2", "I3", "I4", "I5", "I6", "I8", "I9", "G8", "G9", "H8", "H9"], I8: ["A8", "B8", "C8", "D8", "E8", "F8", "G8", "H8", "I1", "I2", "I3", "I4", "I5", "I6", "I7", "I9", "G7", "G9", "H7", "H9"], I9: ["A9", "B9", "C9", "D9", "E9", "F9", "G9", "H9", "I1", "I2", "I3", "I4", "I5", "I6", "I7", "I8", "G7", "G8", "H7", "H8"]}),
       
        DIGITS: ({A1: "123456789", A2: "123456789", A3: "123456789", A4: "123456789", A5: "123456789", A6: "123456789", A7: "123456789", A8: "123456789", A9: "123456789", B1: "123456789", B2: "123456789", B3: "123456789", B4: "123456789", B5: "123456789", B6: "123456789", B7: "123456789", B8: "123456789", B9: "123456789", C1: "123456789", C2: "123456789", C3: "123456789", C4: "123456789", C5: "123456789", C6: "123456789", C7: "123456789", C8: "123456789", C9: "123456789", D1: "123456789", D2: "123456789", D3: "123456789", D4: "123456789", D5: "123456789", D6: "123456789", D7: "123456789", D8: "123456789", D9: "123456789", E1: "123456789", E2: "123456789", E3: "123456789", E4: "123456789", E5: "123456789", E6: "123456789", E7: "123456789", E8: "123456789", E9: "123456789", F1: "123456789", F2: "123456789", F3: "123456789", F4: "123456789", F5: "123456789", F6: "123456789", F7: "123456789", F8: "123456789", F9: "123456789", G1: "123456789", G2: "123456789", G3: "123456789", G4: "123456789", G5: "123456789", G6: "123456789", G7: "123456789", G8: "123456789", G9: "123456789", H1: "123456789", H2: "123456789", H3: "123456789", H4: "123456789", H5: "123456789", H6: "123456789", H7: "123456789", H8: "123456789", H9: "123456789", I1: "123456789", I2: "123456789", I3: "123456789", I4: "123456789", I5: "123456789", I6: "123456789", I7: "123456789", I8: "123456789", I9: "123456789"}),
       
        SQUARES_LENGTH: 81,
        UNITS_LENGTH: 3,
        UNITS_SUM: 45,
        PEERS_LENGTH: 20       
    };
   
   
    sudoku.solver = {
        digits: {},
        /*
         Eliminate all the other digits (except d) from digits[s] and propagate.
         Return digits, except return False if a contradiction is detected.
        */
        assign: function (digits, square, digit) {
            var i, result,
                otherDigits = digits[square].replace(digit, ""),
                nOtherDigits = otherDigits.length;
                               
            for (i = 0; i < nOtherDigits; i++) {
                result = sudoku.solver.eliminate(digits, square, otherDigits[i]);
                if (!result) {
                    return false;
                }
            }
           
            return digits;
        },
       
        eliminate: function (digits, square, digit) {
            var i, s, result, possible;               
            //  Value has already been eliminated.
            if (digits[square].indexOf(digit) === -1) {
                return digits;
            }
           
            // Eliminate
            digits[square] = digits[square].replace(digit, "");
           
            // Can not remove the last value, invalid input?
            if (digits[square].length === 0) {
                return false;
            } else if (digits[square].length === 1) {
                /*
                    If a square's possibilities is reduced to only one digit,
                    then eliminate that digit from all of it peer's.
                */
                result = true;
                for (s in sudoku.PEERS[square]) {
                    if (sudoku.PEERS[square].hasOwnProperty(s)) {
                        result = sudoku.solver.eliminate(digits, sudoku.PEERS[square][s], digits[square]);
                        if (!digits) {
                            return false;
                        }
                    }
                }
            }
           
            /*
                If digit has been removed, check if theres only one 
                square in its' units that the digit possibly can be assigned.
            */
            for (i = 0; i < sudoku.UNITS_LENGTH; i++) {
                possible = [];
                for (s in sudoku.UNITS[square][i]) {
                    if (sudoku.UNITS[square][i].hasOwnProperty(s)) {
                        possible.push(sudoku.UNITS[square][i]);
                    }
                }
                // Invalid input?
                if (possible.length === 0) {
                    return false;
                } else if (possible.length === 1) {
                    result = sudoku.solver.assign(digits, possible[0], digit);
                    if (!result) {
                        return false;
                    }
                }
            }
            
            return digits;
        }
       
    };
   
    sudoku.solve = function (gridDigits) {
        // Get a new copy of the starting point.
        var s;
        sudoku.solver.digits = sudoku.clone(sudoku.DIGITS);
        
        // Try to assign digits from the grid.
        for (s in gridDigits) {
            if (gridDigits.hasOwnProperty(s)) {
                if (!sudoku.solver.assign(sudoku.solver.digits, s, gridDigits[s])) {
                    return false;
                }            
            }
        }
       
        return sudoku.solver.digits;   
    };

    sudoku.parseGrid = function () {
        var i, value,
            gridDigits = {},
            nodeList = global.document.querySelectorAll('table#sudoku tr td input'),
            nNodes = nodeList.length;
        
        // Get valid digits from grid and remove invalid.   
        for (i = 0; i < nNodes; i++) {
            value = +nodeList[i].value;
            if (value > 0 && value < 10) {
                gridDigits[nodeList[i].id] = String(value);
            } else {
                nodeList[i].value = "";
            }
        }   
        
        return gridDigits;
    };
    
    sudoku.populateGrid = function (digits) {
        var i,
            gridDigits = {},
            nodeList = global.document.querySelectorAll('table#sudoku tr td input'),
            nNodes = nodeList.length;
            
        for (i = 0; i < nNodes; i++) {
            if (digits[nodeList[i].id].length === 1) {
                gridDigits[nodeList[i].id] = nodeList[i].value = digits[nodeList[i].id];
            }
        }
        
        return gridDigits;    
    };
    
    sudoku.clearGrid = function () {
        var i,
            nodeList = global.document.querySelectorAll('table#sudoku tr td input'),
            nNodes = nodeList.length;
        
        for (i = 0; i < nNodes; i++) {
            nodeList[i].value = "";
        }
    };
   
    global.sudoku = sudoku;
    return global.sudoku;
   
}(typeof window === 'undefined' ? this : window));